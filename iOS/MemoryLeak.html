<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>iOS 内存泄漏检测 | 柯里君</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="向阳而生">
    
    <link rel="preload" href="/assets/css/0.styles.bb684b6e.css" as="style"><link rel="preload" href="/assets/js/app.a7ca910e.js" as="script"><link rel="preload" href="/assets/js/3.f4bec4dd.js" as="script"><link rel="preload" href="/assets/js/21.5e3e6a00.js" as="script"><link rel="prefetch" href="/assets/js/10.ebf7a222.js"><link rel="prefetch" href="/assets/js/11.9b36eb97.js"><link rel="prefetch" href="/assets/js/12.5166295c.js"><link rel="prefetch" href="/assets/js/13.52220468.js"><link rel="prefetch" href="/assets/js/14.5d789c73.js"><link rel="prefetch" href="/assets/js/15.6bdf57bf.js"><link rel="prefetch" href="/assets/js/16.e9ec0cca.js"><link rel="prefetch" href="/assets/js/17.e124f494.js"><link rel="prefetch" href="/assets/js/18.def0669f.js"><link rel="prefetch" href="/assets/js/19.1512e15f.js"><link rel="prefetch" href="/assets/js/20.8686d5f4.js"><link rel="prefetch" href="/assets/js/22.98ea15d1.js"><link rel="prefetch" href="/assets/js/23.8f81c4fb.js"><link rel="prefetch" href="/assets/js/24.71a19794.js"><link rel="prefetch" href="/assets/js/25.6479f418.js"><link rel="prefetch" href="/assets/js/26.73e74951.js"><link rel="prefetch" href="/assets/js/27.fa0ed151.js"><link rel="prefetch" href="/assets/js/28.c2e85e20.js"><link rel="prefetch" href="/assets/js/29.126b3608.js"><link rel="prefetch" href="/assets/js/4.84d1cee1.js"><link rel="prefetch" href="/assets/js/5.8feca752.js"><link rel="prefetch" href="/assets/js/6.7f0ce380.js"><link rel="prefetch" href="/assets/js/7.03a52a57.js"><link rel="prefetch" href="/assets/js/8.aab68a82.js"><link rel="prefetch" href="/assets/js/9.23ee45a7.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.4b42ec77.js">
    <link rel="stylesheet" href="/assets/css/0.styles.bb684b6e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">柯里君</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="iOS" class="dropdown-title"><span class="title">iOS</span> <span class="arrow down"></span></button> <button type="button" aria-label="iOS" class="mobile-dropdown-title"><span class="title">iOS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/iOS/interview/" class="nav-link">
  知识点
</a></li></ul></div></div><div class="nav-item"><a href="/cook/" class="nav-link">
  下厨房
</a></div><div class="nav-item"><a href="/note/homebrew.html" class="nav-link">
  笔记
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="iOS" class="dropdown-title"><span class="title">iOS</span> <span class="arrow down"></span></button> <button type="button" aria-label="iOS" class="mobile-dropdown-title"><span class="title">iOS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/iOS/interview/" class="nav-link">
  知识点
</a></li></ul></div></div><div class="nav-item"><a href="/cook/" class="nav-link">
  下厨房
</a></div><div class="nav-item"><a href="/note/homebrew.html" class="nav-link">
  笔记
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>iOS 内存泄漏检测</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/iOS/MemoryLeak.html#analyze-静态分析" class="sidebar-link">Analyze 静态分析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/iOS/MemoryLeak.html#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/iOS/MemoryLeak.html#analyze-主要分析以下几种问题" class="sidebar-link">Analyze 主要分析以下几种问题：</a></li></ul></li><li><a href="/iOS/MemoryLeak.html#instruments-leaks" class="sidebar-link">Instruments - Leaks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/iOS/MemoryLeak.html#三种打开方式" class="sidebar-link">三种打开方式</a></li><li class="sidebar-sub-header"><a href="/iOS/MemoryLeak.html#配置" class="sidebar-link">配置</a></li><li class="sidebar-sub-header"><a href="/iOS/MemoryLeak.html#动态分析内存泄露" class="sidebar-link">动态分析内存泄露</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ios-内存泄漏检测"><a href="#ios-内存泄漏检测" class="header-anchor">#</a> iOS 内存泄漏检测</h1> <h2 id="analyze-静态分析"><a href="#analyze-静态分析" class="header-anchor">#</a> Analyze 静态分析</h2> <h3 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h3> <p>Product -&gt; Analyze（快捷键command+shift+B）可以找出代码潜在错误，如内存泄露、未使用函数和变量、循环引用等。
<img src="http://img.kelijun.com/MemoryLeak_Analyze_001.png" alt="image"></p> <div class="custom-block tip"><p class="custom-block-title">注意</p> <p>所谓静态内存分析, 是指在程序没运行的时候, 通过工具对代码直接进行分析
根据代码的上下文的语法结构, 让编译器分析内存情况, 检查是否有内存泄露</p></div> <h3 id="analyze-主要分析以下几种问题"><a href="#analyze-主要分析以下几种问题" class="header-anchor">#</a> Analyze 主要分析以下几种问题：</h3> <ul><li>逻辑错误：访问空指针或未初始化的变量等；</li> <li>内存管理错误：如内存泄漏等；</li> <li>声明错误：从未使用过的变量；</li> <li>Api 调用错误：未包含使用的库和框架。</li></ul> <h2 id="instruments-leaks"><a href="#instruments-leaks" class="header-anchor">#</a> Instruments - Leaks</h2> <h3 id="三种打开方式"><a href="#三种打开方式" class="header-anchor">#</a> 三种打开方式</h3> <h4 id="第一种-xcode-opendevelper-tool-instruments-leaks"><a href="#第一种-xcode-opendevelper-tool-instruments-leaks" class="header-anchor">#</a> 第一种：Xcode -&gt; OpenDevelper Tool -&gt; Instruments -&gt; Leaks</h4> <p><img src="http://img.kelijun.com/MemoryLeak_Leaks_001.png" alt="image"> <img src="http://img.kelijun.com/MemoryLeak_Leaks_002.png" alt="image"></p> <h4 id="第二种-product-profile"><a href="#第二种-product-profile" class="header-anchor">#</a> 第二种：Product -&gt; Profile</h4> <p><img src="http://img.kelijun.com/MemoryLeak_Leaks_003.png" alt="image"></p> <h4 id="第三种"><a href="#第三种" class="header-anchor">#</a> 第三种：</h4> <p><img src="http://img.kelijun.com/MemoryLeak_Leaks_004.png" alt="image"> <img src="http://img.kelijun.com/MemoryLeak_Leaks_005.png" alt="image"></p> <h3 id="配置"><a href="#配置" class="header-anchor">#</a> 配置</h3> <p><img src="http://img.kelijun.com/MemoryLeak_Leaks_006.png" alt="image"></p> <h3 id="动态分析内存泄露"><a href="#动态分析内存泄露" class="header-anchor">#</a> 动态分析内存泄露</h3> <p>首先运行 Leaks ，Leaks 是动态监测，需要操作 APP 观察 Leaks 的泄漏，出现红色叉号就监测到了内存泄露，可以先点击暂停运行。
第一步，点击红色叉号标志；第二步，在第二行的菜单栏选择 Leaks -&gt; Call Tree ；第三步：在底部的菜单栏选择 Call Tree；第四步：选择 Invert Call Tree 和 Hide System Libraries；如下图所示：</p> <ul><li>Separate by Thread：按线程分开做分析，这样更容易揪出那些吃资源的问题线程。特别是对于主线程，它要处理和渲染所有的接口数据，一旦受到阻塞，程序必然卡顿或停止响应。</li> <li>Invert Call Tree：反向输出调用树。把调用层级最深的方法显示在最上面，更容易找到最耗时的操作。</li> <li>Hide System Libraries：隐藏系统库文件。过滤掉各种系统调用，只显示自己的代码调用。</li> <li>Flattern Recursion：拼合递归。将同一递归函数产生的多条堆栈（因为递归函数会调用自己）合并为一条。
<img src="http://img.kelijun.com/MemoryLeak_Leaks_007.png" alt="image"></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a7ca910e.js" defer></script><script src="/assets/js/3.f4bec4dd.js" defer></script><script src="/assets/js/21.5e3e6a00.js" defer></script>
  </body>
</html>
